[phases.setup]
nixPkgs = [
    'php84',
    'php84Packages.composer',
    'php84Packages.intl',
    'php84Packages.zip',
    'php84Packages.gd',
    'nodejs_20'
]

[phases.install]
cmds = ['composer install --optimize-autoloader --no-interaction --ignore-platform-reqs', 'npm install']

[phases.build]
cmds = ['npm run build', 'php artisan optimize']

[start]
cmd = 'php artisan migrate --force && php artisan serve --host=0.0.0.0 --port=$PORT'